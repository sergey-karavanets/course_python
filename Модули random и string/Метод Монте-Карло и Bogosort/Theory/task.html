<h2 style="text-align: center;">Метод Монте-Карло</h2>

<p>Метод Монте-Карло – группа численных методов, основанных на воспроизведении и статистическом анализе большого числа реализаций случайного процесса. Проводится математическое моделирование случайных процессов и параметры их реализации оцениваются статистически. Метод лежит в основе статистического моделирования.</p>

<p><img alt="" height="49" src="https://ucarecdn.com/704b2a93-675a-4991-99dd-09ece7c2c668/" width="49">   Метод Монте-Карло часто называют методом статистических испытаний.</p>

<table align="center" border="1" cellpadding="1" cellspacing="1">
	<caption>Основоположники метода Монте-Карло</caption>
	<tbody>
		<tr>
			<td>
			<figure class="image"><img alt="" height="302" src="https://ucarecdn.com/141fe25b-7579-410b-b9db-a36445d0e4f3/" width="203">
			<figcaption>Станислав Улам</figcaption>
			</figure>
			</td>
			<td>
			<figure class="image"><img alt="" height="294" src="https://ucarecdn.com/ba3dad2d-65cf-4e70-895f-a3d9c90f8f7c/" width="292">
			<figcaption>Джон фон Нейман</figcaption>
			</figure>
			</td>
			<td>
			<figure class="image"><img alt="" height="308" src="https://ucarecdn.com/9cbf8a91-00e2-4c56-8159-8964101e4e76/" width="267">
			<figcaption>Николас Метрополис</figcaption>
			</figure>
			</td>
		</tr>
	</tbody>
</table>

<p>Статистическое моделирование широко применяется для решения задач из различных областей человеческого знания - биологии, химии, физики, экономики и других. Задачи, где широко используется этот подход:</p>

<ul>
	<li>численное интегрирование;</li>
	<li>расчеты в системах массового обслуживания;</li>
	<li>расчеты качества и надежности изделий;</li>
	<li>расчеты прохождения нейтронов и других частиц через вещество;</li>
	<li>передача сообщений при наличии помех;</li>
	<li>задачи теории игр;</li>
	<li>задачи динамики разреженного газа;</li>
	<li>задачи дискретной оптимизации;</li>
	<li>задачи финансовой математики.</li>
</ul>

<h2 style="text-align: center;">Вычисление площадей</h2>

<p>Применим метод Монте-Карло и к задаче вычисления площади геометрической фигуры на плоскости.</p>

<p>Поместим фигуру в прямоугольник и будем наугад бросать точки в этот прямоугольник. Будем исходить из того, что чем больше площадь фигуры, тем чаще в нее будут попадать точки. Таким образом, при большом числе $n$ точек, наугад выбранных внутри прямоугольника, доля точек, содержащихся в данной фигуре $k$, приближенно равна отношению площади этой фигуры и площади прямоугольника.</p>

<p>Если площадь прямоугольника равна $S_0$ и в результате испытаний, из которых при $k$ исходах случайные точки оказались внутри фигуры, то площадь $S$ фигуры будет определяться выражением $$S = \dfrac{k}{n} \cdot S_0.$$ Рассмотрим алгоритм решения задачи на конкретных примерах.</p>

<p><strong>Пример 1.</strong> Рассмотрим фигуру, множество точек которой определяется следующей системой неравенств:</p>

<p><span class="math-tex">\[\begin{cases} 0\le x \le 1\\ 0\le y \le 1\\ y\le x^2\end{cases}\]</span>Графическое изображение указанной фигуры в плоскости $xOy$ имеет вид:</p>

<p style="text-align: center;"><img alt="" height="506" src="https://ucarecdn.com/9fe3fe1e-fd53-4241-a4aa-ac20f19ebe8d/" width="506"></p>

<p>Площадь такой фигуры $S = \dfrac13 \approx 0.33333$ (считается через интеграл).</p>

<p><strong>Алгоритм Монте-Карло: </strong>площадь искомой фигуры составляет часть квадрата со сторонами $1$. Площадь такого квадрата равна $1$.</p>

<ol>
	<li>Генерируем случайные числа $x$ и $y$ равномерно распределенные на отрезке $[0; \, 1]$. Это будут координаты случайной точки в квадрате, в которую заключена фигура, площадь которой требуется найти. Полученная точка может как попасть в исследуемую фигуру, так и не попасть.</li>
	<li>Проверяем принадлежность точки к исследуемой фигуре. Если попадания нет, т.е. не выполняется неравенство $y \le x^2$, то переходим к пункту 1 и генерируем координаты новой точки. Если попадание есть, то фиксируем это попадание, то есть увеличиваем на единицу значение счетчика числа попаданий и снова переходим к пункту 1.</li>
</ol>

<p style="text-align: center;"><img alt="" height="512" src="https://ucarecdn.com/cfc26f84-fdc7-4432-843e-9c819acced83/" width="512"></p>

<p><strong>Примечание.</strong> Заметим, что попадание случайной точки точно на границу фигуры можно отнести как к первому, так и ко второму исходу.</p>

<p>Пункты $1$ и $2$ следует повторить в цикле достаточно большое количество $n$ раз. От количества повторений напрямую зависит точность результата. После проведения $n$ повторов площадь фигуры найдем по формуле: $$S = \dfrac{k}{n} \cdot S_0.$$</p>

<p>Пример программы на Python:</p>

<pre><code class="language-python">import random

n = 1000
k = 0
s0 = 1
for _ in range(n):
    x = random.uniform(0, 1)     # случайное число с плавающей точкой от 0 до 1
    y = random.uniform(0, 1)     # случайное число с плавающей точкой от 0 до 1

    if y &lt;= x**2:                # если попадает в нужную область
        k += 1

print((k/n)*s0)</code></pre>

<p>Составим таблицу:</p>

<table align="center" border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="text-align: center;">$n$</td>
			<td style="text-align: center;">$S$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$10$</td>
			<td style="text-align: center;">$0.6$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$100$</td>
			<td style="text-align: center;">$0.37$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$1000$</td>
			<td style="text-align: center;">$0.337$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$10000$</td>
			<td style="text-align: center;">$0.3337$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$100000$</td>
			<td style="text-align: center;">$0.33329$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$1000000$</td>
			<td style="text-align: center;">$0.333571$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$10000000$</td>
			<td style="text-align: center;">$0.3332828$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$100000000$</td>
			<td style="text-align: center;">$0.33336707$</td>
		</tr>
	</tbody>
</table>

<p><strong>Пример 2.</strong> Рассмотрим фигуру, множество точек которой определяется следующей системой неравенств:</p>

<p><span class="math-tex">\[\begin{cases} -2\le x \le 2\\ -2\le y \le 2\\ y^3-2x^2 \le -1\\ 2y+x^3 \le 3 \end{cases}\]</span>Графическое изображение указанной фигуры в плоскости $xOy$ имеет вид:</p>

<p style="text-align: center;"><img alt="" height="643" src="https://ucarecdn.com/5f0652cf-0098-4cdd-a47c-de194b3bc4e3/" width="643"></p>

<p>Площадь этой фигуры нам заранее известна и равна $S = 8.38404$.</p>

<p style="text-align: center;"><img alt="" height="699" src="https://ucarecdn.com/dbebbc79-a578-4bfa-b5ef-5c3b8816ef67/" width="699"></p>

<p><strong>Алгоритм Монте-Карло: </strong>площадь искомой фигуры составляет часть квадрата со сторонами $4$. Площадь такого квадрата равна $16$.</p>

<ol>
	<li>Генерируем случайные числа $x$ и $y$, равномерно распределенные на отрезках $[-2; \, 2]$. Это будут координаты случайных точек в квадрате, в который заключена фигура искомой площади. Полученная точка может как попасть в исследуемую фигуру, так и не не попасть.</li>
	<li>Проверяем принадлежность точки к исследуемой фигуре. Если попадания нет, не выполняется хотя бы одно из  неравенств $y^3-2x^2 \le -1$ или $2y+x^3 \le 3$, переходим к пункту $1$ и генерируем координаты новой точки. Если попадание есть, фиксируем это попадание, то есть увеличиваем на единицу значение счетчика числа попаданий и снова переходим к пункту $1$.</li>
</ol>

<pre><code class="language-python">import random

n = 1000
k = 0
s0 = 16
for _ in range(n):
    x = random.uniform(-2, 2)
    y = random.uniform(-2, 2)

    if y**3 - 2*x**2 &lt;= -1 and 2*y + x**3 &lt;= 3:
        k += 1

print((k/n)*s0)</code></pre>

<p>Составим таблицу:</p>

<table align="center" border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="text-align: center;">$n$</td>
			<td style="text-align: center;">$S$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$10$</td>
			<td style="text-align: center;">$9.6$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$100$</td>
			<td style="text-align: center;">$8.96$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$1000$</td>
			<td style="text-align: center;">$8.224$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$10000$</td>
			<td style="text-align: center;">$8.3824$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$100000$</td>
			<td style="text-align: center;">$8.36528$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$1000000$</td>
			<td style="text-align: center;">$8.383376$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$10000000$</td>
			<td style="text-align: center;">$8.3841584$</td>
		</tr>
		<tr>
			<td style="text-align: center;">$100000000$</td>
			<td style="text-align: center;">$8.38404134$</td>
		</tr>
	</tbody>
</table>

<h2 style="text-align: center;">Примечания</h2>

<p><strong>Примечание 1.</strong> Свое экзотическое название метод получил от города Монте-Карло в княжестве Монако, известного благодаря казино, поскольку именно рулетка является одним из самых широко известных генераторов случайных чисел. Станислав Улам пишет в своей автобиографии «Приключения математика», что название было предложено Николасом Метрополисом в честь его дяди, азартного игрока.</p>

<p style="text-align: center;"><img alt="" src="https://e.profkiosk.ru//service_tbn2/9b62c152-c8a4-47c5-ab45-a0a3ab3d7a04.gif"></p>

<p><strong>Примечание 2.</strong> Активное применение метода началось с появлением ЭВМ, способных выполнять сотни операций для получения необходимых статистических данных. Развитие метода Монте-Карло пришлось на 1950-е годы, когда его использовали ученые из лаборатории ВВС США и исследовательской корпорации RAND, работающие над созданием водородной бомбы, в том числе и гениальный ученый Джон фон Нейман. Неймана считают одним из основателей метода, как, впрочем, и самих ЭВМ.</p>

<p><strong>Примечание 3.</strong> Аналогичным образом можно вычислять объемы тел в пространстве.</p>

<p><strong>Примечание 4.</strong> Подробнее о методе Монте-Карло можно почитать <a href="https://ru.qaz.wiki/wiki/Monte_Carlo_method" rel="noopener noreferrer nofollow">тут</a>.</p>

<h2 style="text-align: right;"><strong>Made with 💛 by BEEGEEK</strong></h2>